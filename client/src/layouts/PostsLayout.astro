---
import Layout from "./Layout.astro";
interface Props {
    title: string;
}
const { title } = Astro.props;

let user = {
    username: "",
    id: 0
}

const token = Astro.cookies.get('token');
if (token) {
    const payload = JSON.parse(atob(token.value.split('.')[1])); // Token payload
    user.username = payload.username;
    user.id = payload.id;
}


---

<Layout title={title}>
    <article class="h-full grid rows-auto-1fr">
        <section>
            <div class="bg-twcolor-900 text-white px-4 pt-3 pb-1">
                <a class="text-4xl" href="/">Peanut</a>
            </div>
            <nav class="bg-twcolor-950 text-white px-4 py-0.5 flex flex-row justify-between">
                <div class="flex flex-row gap-4">
                    <a href="/posts">posts</a>
                    <p>&#9733;</p>
                    <a href="/upload">upload</a>
                    <p>&#9733;</p>
                    <a href="/about">about</a>
                </div>
                <div class="flex flex-row gap-4">
                    {user.id?
                        <a href=`/user/${user.id}`>Welcome, {user.username}</a>
                        <p>&#9733;</p>
                        <a href=`/logout`>logout</a>
                        :
                        <a href="/login">login</a>
                        <p>&#9733;</p>
                        <a href="/signup">sign up</a>
                    }
                </div>
            </nav>
        </section>

        <slot />

    </article>
</Layout>